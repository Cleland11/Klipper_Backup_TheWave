##LED Effects

[gcode_macro _CASELIGHT_VARS]
variable_brightness: 1.0
gcode:

[gcode_macro lights_on]
gcode:
    STOP_LED_EFFECTS
    SET_GCODE_VARIABLE MACRO=_CASELIGHT_VARS VARIABLE=brightness VALUE=1.0
    SET_CASELIGHT_BRIGHTNESS

[gcode_macro lights_off]
gcode:
    SET_GCODE_VARIABLE MACRO=_CASELIGHT_VARS VARIABLE=brightness VALUE=0.0
    SET_CASELIGHT_BRIGHTNESS

[gcode_macro SET_CASELIGHT_BRIGHTNESS]
description: Set chamber light brightness (0.0-1.0, white)
gcode:
    {% set bright = params.BRIGHTNESS|default(printer["gcode_macro _CASELIGHT_VARS"].brightness|default(1.0))|float %}
    {% if bright < 0.0 %}{% set bright = 0.0 %}{% endif %}
    {% if bright > 1.0 %}{% set bright = 1.0 %}{% endif %}
    SET_GCODE_VARIABLE MACRO=_CASELIGHT_VARS VARIABLE=brightness VALUE={bright}
    {% if bright > 0 %}
        SET_LED LED=caselight RED={bright} GREEN={bright} BLUE={bright} SYNC=0 TRANSMIT=1
    {% else %}
        SET_LED LED=caselight RED=0 GREEN=0 BLUE=0 SYNC=0 TRANSMIT=1
    {% endif %}

#[led_effect caselights_on]
#autostart:              false
#frame_rate:             24
#leds:
#    neopixel:caselight
#layers:
#    static  1 1 top (1,1,1)

[led_effect idle]
autostart:              false
frame_rate:             24
leds:
  neopixel:caselight
layers:
    breathing  10 1 top (.5,.5,1)

[gcode_macro idle]
gcode:
    STOP_LED_EFFECTS
    SET_LED_EFFECT EFFECT=idle FADETIME=1

[led_effect white_static]
autostart: false
frame_rate: 24
leds:
    neopixel:caselight  # Exact match to your [neopixel caselight] name
layers:
    static 0 0 add (1,1,1,1)  # Full white (RGBW); use (1,1,1) if RGB only

[led_effect rainbow]
autostart:              false
frame_rate:             24
leds:
    neopixel:caselight
layers:
    gradient 1 1 top (1,0,0),(0,1,0),(0,0,1)

[gcode_macro rainbow]
gcode:
    STOP_LED_EFFECTS
    SET_LED_EFFECT EFFECT=rainbow FADETIME=1

[led_effect case_homing]  # Rename to avoid conflicts if needed
autostart: false
frame_rate: 24
endstops: stepper_x, stepper_y, stepper_z, probe
leds:
    neopixel:caselight
layers:
    static 0 0 add (1,1,1)      # Solid full white base (adjust RGB if your strip is RGBW: (1,1,1,1))
    homing 3 0 top (1,1,1)      # Homing flash/trigger layer on top; rate 3-5 for quick response, no fade interference

[gcode_macro led_status_homing]
gcode:
    STOP_LED_EFFECTS
    SET_LED_EFFECT EFFECT=case_homing  # Match the name above

[led_effect bed_mesh_probe]
autostart: false
frame_rate: 24
leds:
    neopixel:caselight
endstops: probe
layers:
  homing 1 0 top (0,1,0)  # Green flash/fade on each probe trigger (rate=1 for ~1s fade; adjust for quicker flash)

[gcode_macro led_status_meshing]  # Or STATUS_LEVELING if you use that for bed-related ops
gcode:
    STOP_LED_EFFECTS
    SET_LED_EFFECT EFFECT=bed_mesh_probe  # Start the probing flash effect

[gcode_macro led_status_ready]  # Assuming you have this for idle/complete states
gcode:
    STOP_LED_EFFECTS
    SET_LED_EFFECT EFFECT=white_static  # Or directly: SET_LED LED=caselight RED=1 GREEN=1 BLUE=1

[led_effect warm_up]
autostart: false
frame_rate: 24
heater: extruder
leds:
    neopixel:caselight
layers:
    heater 20 0 add (0,0,1),(0,0.5,1),(0,1,0.5),(1,1,0),(1,0.5,0),(1,0,0)
    
#[led_effect warm_up]
#autostart:              false
#frame_rate:             24
#heater: extruder
#leds:
#    neopixel:caselight
#layers:
#    temperature 1 1 top (1,0,0),(0,0,1)

[gcode_macro led_status_heating]
gcode:
    STOP_LED_EFFECTS
    SET_LED_EFFECT EFFECT=warm_up